#!/usr/bin/env bash

echo "Installing tmux..."

# Detect the distribution
detect_distro() {
    if command -v pacman &>/dev/null; then
        echo "arch"
    elif command -v apt &>/dev/null; then
        echo "debian"
    else
        echo "unknown"
    fi
}

# Check if we're in a container (no sudo) or regular system
if command -v sudo &>/dev/null; then
    SUDO_CMD="sudo"
else
    SUDO_CMD=""
fi

DISTRO=$(detect_distro)
echo "Detected distribution: $DISTRO"

case $DISTRO in
    arch)
        echo "Installing tmux from Arch repositories..."
        $SUDO_CMD pacman -S --noconfirm --needed tmux
        ;;
    
    debian)
        echo "Installing tmux from apt repositories..."
        $SUDO_CMD apt update
        DEBIAN_FRONTEND=noninteractive $SUDO_CMD apt install -y tmux
        ;;
    
    *)
        echo "Unsupported distribution"
        exit 1
        ;;
esac

echo "tmux installation complete!"
tmux -V
