#!/usr/bin/env bash

echo "Installing Rust toolchain..."

# Check if rustup is already installed
if command -v rustup &>/dev/null; then
    echo "rustup already installed, updating..."
    rustup update stable
    source $HOME/.cargo/env
else
    echo "Installing rustup..."
    # Install rustup non-interactively
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    source $HOME/.cargo/env
fi

# Install or update stylua
echo "Installing/updating stylua..."
cargo install stylua --features luajit --force

echo "Rust installation complete!"
rustc --version
cargo --version
stylua --version
